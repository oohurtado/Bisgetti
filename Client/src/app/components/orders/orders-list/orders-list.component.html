<div class="row">
    <div class="col-md-6">
        <h3>Mis pedidos</h3>
    </div>
    <div class="col-md-6 text-end">
        <app-processing [text]="'Procesando...'" *ngIf="_isProcessing"></app-processing>
    </div>
    <div class="col-md-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a [routerLink]="['/home']">Inicio</a></li>
                <li class="breadcrumb-item active" aria-current="page">Mis pedidos</li>
            </ol>
        </nav>
    </div>
</div>

<ng-container *ngIf="_error !== null">
    <div class="alert alert-danger mt-4 ml-4 mr-4" role="alert">
        {{ _error }}
    </div>
</ng-container>

<ng-container *ngIf="_error === null">
    <div class="row">
        <div class="col-md-6">
        </div>
        <div class="col-md-6 text-end">
            <app-page-order class="ms-1 me-1" [data]="_pageOrder" (evt)="onOrderClicked($event)"></app-page-order>
            <app-page-sync class="ms-1" (evt)="onSyncClicked()"></app-page-sync>
        </div>
    </div>
    <div *ngIf="_pageData?.data?.length == 0" class="text-center mt-2">
        No hay datos para mostrar
    </div>
    <ng-container *ngFor="let order of _pageData?.data" class="">
        <div class="card text-start mt-2">
            <div class="card-header">
                <div class="row">                    
                    <div class="col-6 text-start">
                        Total<br>{{ getTotal(order) | currency:'$' }}
                    </div>
                    <div class="col-6 text-end">
                        Pedido<br>#{{ order.id.toString().padStart(6, '0') }}
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div style="padding-left: 0px;">
                            <strong>General</strong><br>
                            <div style="padding-left: 20px;">
                                Productos ({{ order.productCount }}): {{ order.productTotal | currency:'$' }}<br>
                                Costo de env√≠o: {{ order.shippingCost | currency:'$' }}<br>
                                Propina: {{ getTip(order) | currency:'$' }}<br>
                                Total: {{ getTotal(order) | currency:'$' }}
                                <hr>
                                Pagando con: {{ order.payingWith | currency:'$' }}<br>
                                Comentarios: {{ getComments(order) }}<br>
                                Entrega del producto: {{ order.deliveryMethod | deliveryMethod }}
                            </div>
                            <div style="padding-left: 40px;" *ngIf="order.address !== null">
                                {{ getAddress(order) }}
                            </div>
                        </div>
                        <div style="padding-left: 0px;" *ngIf="order.orderStatuses !== null && order.orderStatuses.length > 0">
                            <strong>Estatus</strong><br>
                            <div style="padding-left: 20px;">
                                <div *ngFor="let status of order.orderStatuses">
                                    {{ status.status }}, {{ dateService.get_longDate(status.eventAt) }}, {{ dateService.get_time(status.eventAt) }}
                                </div>
                            </div>                            
                        </div>       
                    </div>
                    <div class="col-md-6" *ngIf="order.orderElements !== null && order.orderElements.length > 0">
                        <div style="padding-left: 0px;">
                            <strong>Productos</strong><br>
                            <div style="padding-left: 20px;">
                                <pre>{{ order.orderElements | json }}</pre>                                
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-md-6">                      
                        Productos<br>
                            &nbsp;&nbsp;&nbsp;Oscar<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coca Cola (1) $25.00<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total por persona: $25.00<br>
                            &nbsp;&nbsp;&nbsp;Franco<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coca Cola (1) $25.00<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Torta de carne asada(1) $50.00<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total por persona: $75.00<br>
                        <hr>
                    </div> -->
                    <div class="col-12">
                        <div class="text-end mt-2">
                            <a (click)="onLoadOrderDetailsClicked($event, order)" class="btn btn-primary">Ver detalles</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer text-muted">
                Creado el {{ dateService.get_longDate(order.createdAt) }}, {{ dateService.get_time(order.createdAt) }}
            </div>
        </div>
    </ng-container>
	<div class="row mt-2">
		<div class="col-md-12 text-end">				
			<app-page-pagination [pageSelected]="pageSelected" [pageSize]="pageSize" (evt_pageOption)="onPageOptionClicked($event)" (evt_pageSize)="onPageSizeClicked($event)"></app-page-pagination>
		</div>
	</div>    
</ng-container>

<pre>{{ _pageData | json }}</pre>